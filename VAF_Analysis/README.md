Scripts associated with variant allele fraction analysis.

(1) Subset TCGA germline .maf by sex and to chrX coding variants (run files prefixed by: maf_subset_chrX_coding_).

(2) Subset .maf to expressed regions (TPM>2) and annotate variants (run files prefixed by: maf_non_escape_subset_TPM_annotate_maf_).

(3) Run maf_extract.py. This script extracts the hg19 positions from the input .maf file. These coordinates need to be converted into the hg38 positions using UCSC genome liftover (https://genome.ucsc.edu/cgi-bin/hgLiftOver).

(4) Run modify.csv. This script adds the hg38 coordinate positions to the .maf file from the .bed file generated by UCSC genome liftover.

(5) Run joint_name_table_DNA.py and joint_name_table_RNA.py. These scripts obtain the file paths for the whole exome sequencing data and bulk RNA sequencing data (BAM files) for each sample that needs to be iterated over.

(6) Run extract_count_all_chr.py. This script computes the VAF for the variants of interest using the WES and RNA-seq .bam files identified in the previous step. Specifically, DNA VAF was calculated as (alternative allele count) / (reference allele count + alternative allele count) in DNA, and RNA VAF was calculated as (alternative allele count) / (reference allele count + alternative allele count) in RNA.

(7) Run separated_CCF_plots_chrX_CN_2_no_axis_break.py. This script calculates the CCF of each variant based on DNA VAF, TITAN copy number calls, and TITAN purity calls. It subsets to clonal variants (CCF = 1). Additionally, all variants with total depth (reference allele depth + alternative allele depth) < 20 reads for either DNA or RNA are excluded. The script generates plots which have been included in the manuscript. One can specify the plot type by modifying the following variables:

- gene_class (can be either "Escapee" or "Non-Escapee")
- cn_to_analyze (can be either 1 or 2)
